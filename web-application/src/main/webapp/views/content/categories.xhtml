<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                template="/layouts/contentsLayout.xhtml">
    <ui:define name="contentSection">
        <p:dataTable id="categories" var="category" value="#{categoriesBean.dataModel}"
                     widgetVar="categories" lazy="true"
                     styleClass="textLeft"
                     emptyMessage="#{msg['system.common.empty']}"
                     rows="10" paginator="true" paginatorPosition="bottom"
                     paginatorTemplate="{PreviousPageLink} {PageLinks} {NextPageLink} {RowsPerPageDropdown}"
                     rowsPerPageTemplate="10,15,20">
            <f:facet name="header">
                <p:toolbarGroup align="left" style="text-aign:left">
                    <p:commandButton id="add" value="#{msg['system.button.add.label']}" icon="ui-icon-plus"
                                     update=":mainForm:categoryPanel"
                                     onsuccess="PF('dialog').show();" process="@this"
                                     actionListener="#{categoriesBean.onAddCategory}"/>
                </p:toolbarGroup>
            </f:facet>

            <p:ajax event="page" global="false"/>

            <p:column selectionMode="single" style="width:16px;text-align:center"/>

            <p:column headerText="#{msg['cms.category.name.label']}" styleClass="textLeft">
                <p:commandLink actionListener="#{categoriesBean.onEditCategory}" oncomplete="PF('dialog').show();"
                               update=":mainForm:messages,:mainForm:dialog" process="@this">
                    <f:attribute name="categoryId" value="#{category.id}"/>
                    <h:outputText value="#{category.tittle}" title="/#{config['cms.default.category.prefix']}/#{category.friendlyUrl}"/>
                </p:commandLink>
            </p:column>

            <p:column headerText="#{msg['resource.last.update.time']}" styleClass="textLeft" width="120">
                <h:outputText value="#{category.createDate}" styleClass="leave-date">
                    <f:convertDateTime pattern="#{config['date.format']}"/>
                </h:outputText>
            </p:column>
        </p:dataTable>

        <p:dialog id="dialog" header="#{msg['cms.category.dialog.title']}" widgetVar="dialog"
                  position="center,center"
                  resizable="false" appendTo="mainForm" modal="true" width="650" height="420">
            <h:panelGrid id="categoryPanel" columns="3" styleClass="textLeft">

                <p:outputLabel for="categoryName" value="#{msg['cms.category.name.label']}"/>
                <p:inputText id="categoryName" value="#{categoriesBean.editCategory.tittle}" required="true"
                             requiredMessage="#{msg['cms.default.require.msg']}"
                             maxlength="255" size="80"/>
                <p:message for="categoryName" display="icon"/>

                <p:outputLabel for="categoryFriendlyUrl" value="#{msg['cms.category.friendly.url']}"/>
                <h:panelGrid columns="2">
                    <h:outputText value="/#{config['cms.default.category.prefix']}/"/>
                    <p:inputText id="categoryFriendlyUrl" value="#{categoriesBean.editCategory.friendlyUrl}"
                                 required="true"
                                 requiredMessage="#{msg['cms.default.require.msg']}"
                                 maxlength="255" size="70"/>
                </h:panelGrid>
                <p:message for="categoryFriendlyUrl" display="icon"/>

                <p:outputLabel for="categoryMetaKeyword" value="#{msg['cms.category.meta.keyword']}"/>
                <p:inputTextarea id="categoryMetaKeyword" rows="3" cols="80"
                                 value="#{categoriesBean.editCategory.metaKeyword}" autoResize="false"/>
                <p:message for="categoryMetaKeyword" display="icon"/>

                <p:outputLabel for="categoryMetaDescription" value="#{msg['cms.category.meta.description']}"/>
                <p:inputTextarea id="categoryMetaDescription" rows="3" cols="80"
                                 value="#{categoriesBean.editCategory.metaDescription}" autoResize="false"/>
                <p:message for="categoryMetaDescription" display="icon"/>
            </h:panelGrid>
            <h:panelGrid columns="3">
                <p:outputLabel for="desc" value="#{msg['cms.category.description.label']}"/>
                <p:message for="desc" display="icon"/>
                <pe:ckEditor id="desc" value="#{categoriesBean.editCategory.description}" skin="kama" width="500"
                             height="150"
                             toolbar="#{config['leave.editor.tools']}"/>
            </h:panelGrid>

            <f:facet name="footer">
                <p:commandButton value="#{msg['system.button.save.label']}" action="#{categoriesBean.saveCategory}"
                                 process="dialog" styleClass="k-primary"
                                 update=":mainForm:categories,messages,categoryPanel"/>
                <p:commandButton value="#{msg['system.button.cancel.label']}" immediate="true" style="margin-left: 5px;"
                                 global="false"
                                 onclick="PF('dialog').hide();"/>
            </f:facet>
        </p:dialog>
    </ui:define>
</ui:composition>
