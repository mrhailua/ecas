<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                template="/layouts/contentsLayout.xhtml">
    <ui:define name="contentSection">
        <p:toolbar>
            <f:facet name="left">
                <p:commandButton action="#{handleContentBean.saveArtical}" value="#{msg['system.button.save.label']}"
                                 styleClass="k-primary"
                                 update="editPage,messages"/>
                <p:button outcome="/views/content/contents" value="#{msg['system.button.cancel.label']}"/>
            </f:facet>
        </p:toolbar>

        <h:panelGrid id="editPage" columns="2" styleClass="textLeft" style="width: 100%">
            <h:panelGrid columns="1" styleClass="textLeft">
                <h:panelGrid columns="3" styleClass="textLeft">
                    <p:outputLabel for="contentTitle"
                                   value="#{msg['cms.content.title.label']}"/>
                    <p:inputText id="contentTitle" value="#{handleContentBean.artical.tittle}" size="100"
                                 required="true"
                                 requiredMessage="#{msg['cms.default.require.msg']}"
                                 styleClass="textLeft">
                    </p:inputText>
                    <p:message for="contentTitle" display="icon"/>

                    <p:outputLabel for="friendlyUrl"
                                   value="#{msg['cms.content.friendly.url.label']}"/>
                    <p:inputText id="friendlyUrl" value="#{handleContentBean.artical.friendlyUrl}" size="100"
                                 required="true"
                                 requiredMessage="#{msg['cms.default.require.msg']}"
                                 styleClass="textLeft">
                    </p:inputText>
                    <p:message for="friendlyUrl" display="icon"/>


                    <p:outputLabel for="category" value="#{msg['menu.content.category.label']}"/>
                    <p:selectOneMenu id="category" value="#{handleContentBean.artical.categoryId}" style="width:150px">
                        <f:selectItem itemLabel="#{msg['cms.empty.selection.label']}"
                                      itemValue=""/>
                        <f:selectItems value="#{handleContentBean.categories}" var="category"
                                       itemLabel="#{category.tittle}"
                                       itemValue="#{category.id}"/>
                    </p:selectOneMenu>
                    <p:message for="category" display="icon"/>

                    <p:outputLabel for="renderPage" value="#{msg['cms.content.render.template.label']}"/>
                    <p:selectOneMenu id="renderPage" value="#{handleContentBean.artical.renderedPageId}"
                                     style="width:150px" required="true"
                                     requiredMessage="#{msg['cms.default.require.msg']}">
                        <f:selectItem itemLabel="#{msg['cms.empty.selection.label']}"
                                      itemValue=""/>
                        <f:selectItems value="#{handleContentBean.pages}" var="page"
                                       itemLabel="#{page.name}"
                                       itemValue="#{page.id}"/>
                    </p:selectOneMenu>
                    <p:message for="renderPage" display="icon"/>

                </h:panelGrid>
                <h:panelGrid columns="1" styleClass="textLeft">
                    <p:outputLabel for="shortDescription" value="#{msg['cms.content.short.description.label']}"/>
                    <h:panelGrid columns="2" styleClass="textLeft">
                        <p:message for="shortDescription" display="icon"/>
                        <pe:ckEditor id="shortDescription" value="#{handleContentBean.artical.shortDescription}"
                                     required="true"
                                     skin="kama"
                                     height="150" width="800"
                                     toolbar="#{config['leave.editor.tools']}"
                                     requiredMessage="#{msg['cms.default.require.msg']}"/>
                    </h:panelGrid>

                    <p:outputLabel for="metaKeyword" value="#{msg['cms.content.meta.key.label']}"/>
                    <h:panelGrid columns="2" styleClass="textLeft">
                        <p:message for="metaKeyword" display="icon"/>
                        <p:inputTextarea id="metaKeyword" rows="5" cols="120"
                                         value="#{handleContentBean.artical.metaKeyword}" autoResize="false"/>
                    </h:panelGrid>

                    <p:outputLabel for="metaDescription" value="#{msg['cms.content.meta.description.label']}"/>
                    <h:panelGrid columns="2" styleClass="textLeft">
                        <p:message for="metaDescription" display="icon"/>
                        <p:inputTextarea id="metaDescription" rows="5" cols="120"
                                         value="#{handleContentBean.artical.metaDescription}"
                                         autoResize="false"/>
                    </h:panelGrid>

                    <p:outputLabel for="articalContent" value="#{msg['cms.content.content.label']}"/>
                    <h:panelGrid columns="2" styleClass="textLeft">
                        <p:message for="articalContent" display="icon"/>
                        <pe:ckEditor id="articalContent" value="#{handleContentBean.artical.content}" required="true"
                                     skin="kama"
                                     height="300" width="800"
                                     requiredMessage="#{msg['cms.default.require.msg']}"/>

                    </h:panelGrid>
                </h:panelGrid>
            </h:panelGrid>

            <h:panelGrid>
                <p:panel id="artialAvatarPanel" style="width:277px;height: 150px">
                    <f:facet name="header">
                        <p:commandLink value="#{msg['system.button.add.avatar.label']}" icon="ui-icon-plus"
                                       oncomplete="PF('dlg').show();" global="false" immediate="true"/>
                    </f:facet>
                    <h:graphicImage
                            value="/fileservice/#{handleContentBean.artical.avatarRef.id}/#{handleContentBean.artical.avatarRef.name}"
                            style="max-height: 100px"
                            rendered="#{handleContentBean.artical.avatarRef != null}"/>

                </p:panel>
                <p:dataTable id="frontEndResources" var="frontEndResource" value="#{imageResourceBean.dataModel}"
                             widgetVar="frontEndResources"
                             styleClass="textLeft" selection="#{imageResourceBean.selectedResources}"
                             emptyMessage="#{msg['system.common.empty']}"
                             rows="30" paginator="true" paginatorPosition="bottom"
                             paginatorTemplate="{PreviousPageLink} {PageLinks} {NextPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="30">

                    <f:facet name="header">
                        <h:outputText value="#{msg['cms.image.file.name']}"/>
                    </f:facet>

                    <p:ajax event="page" global="false"/>
                    <p:ajax event="filter" global="false"/>

                    <p:column styleClass="textLeft" filterBy="#{frontEndResource.name}">
                        <a href="/fileservice/#{frontEndResource.id}/#{frontEndResource.name}">
                            <h:outputText value="#{frontEndResource.name}"/>
                        </a>
                    </p:column>

                </p:dataTable>
            </h:panelGrid>
        </h:panelGrid>

        <p:dialog id="dialog" header="#{msg['leave.profile.avatar.upload.title']}" widgetVar="dlg" dynamic="true"
                  position="center,center" resizable="false" appendTo="mainForm" modal="true">
            <h:panelGrid id="resourceFile" columns="1" styleClass="textLeft">
                <p:fileUpload fileUploadListener="#{handleContentBean.handleUploadAvatar}" mode="advanced"
                              dragDropSupport="true" multiple="true"
                              update="messages,artialAvatarPanel"
                              sizeLimit="#{config['image.file.max.limit']}"
                              oncomplete="PF('dlg').hide()" label="#{msg['iwork.repository.file.upload.choose']}"
                              uploadLabel="#{msg['iwork.repository.file.upload.upload']}"
                              cancelLabel="#{msg['iwork.repository.file.upload.cancel']}" styleClass="upload-panel"
                              allowTypes="/(\.|\/)(jpg|png)$/"
                              invalidFileMessage="#{msg['cms.file.image.type.invalid']}"
                              invalidSizeMessage="#{msg['cms.file.image.size.invalid']}"/>
            </h:panelGrid>
        </p:dialog>
    </ui:define>
</ui:composition>
